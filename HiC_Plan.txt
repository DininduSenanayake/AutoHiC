4.19-

=pdo

# Document
	HiC 可视化
		https://xuzhougeng.top/archives/HiC-visualization-in-assembly

	HiCPlotter:Hi-C数据可视化工具
		https://github.com/akdemirlab/HiCPlotter

	Hi-C辅助基因组组装原理 | 主流软件
		https://lxz9.com/2021/04/03/HiC/

	HiCExplorer
		https://hicexplorer.readthedocs.io/en/latest/content/list-of-tools.html

	3D-DNA辅助组装策略
		https://www.jianshu.com/p/a4259efc0f80

	Galaxy HiC
		https://galaxyproject.eu/index-hicexplorer.html

	HiC 文件格式转换
		https://hicexplorer.readthedocs.io/en/latest/content/tools/hicConvertFormat.html

	merged_nodups.txt 文件格式 
		https://github.com/aidenlab/juicer/wiki/Pre#short-with-score-format



	# wait to do
		测试跑 最后一步3d-dna需要多久时间（线程指定16， 48）
		Juice最后一步的脚本学习 run.sh

	HiC-Glass 


=cut



# 4.20
	整理Problems (Done)
	搭建挂载HiC环境 (Done > ssh -p 10086 root@192.168.1.109)

# 4.21
	跑HiCUP HiC-Pro Juicer (Done)
	HiC jupyter > Windows 
	

# 4.22
	实例.hic 与self.hic的 差异
	HiCExplorer	

# 4.25
	HiCPlotter
	merged_nodups.txt 文件格式 
		https://github.com/aidenlab/juicer/wiki/Pre#short-with-score-format
	Code : 自动生成HiC图片 （制造HiC错误，用于构建训练集）
	

# 4.28
	why .hic 没有信息， 如何生成这些信息, 已提问，等待回复



# 5.5
	可视化颜色的调整，接近Juicebox（Done）
		参考Juicebox中自动调整的range即可

	测试HIC001 自己构建`.assembly`文件，导入Juicebox，是否有效（Done）
		有一定效果，但是基本不起作用，无法使用

	*测试各种分辨率下不同序列长度选取的可视化图片(Done)
		在特定的分辨率下，以多大的区间进行产生数据
	

# 5.9
	查看HiC-Pro运行结果 (Done)


# 5.10
	全局染色体模型，利用HicPlotter来构建数据集( Done )
		Straw 也可以实现，将分辨率调整到最高
	
# 5.19 - 5.20
	
	列出总共需要那几个函数，每个函数需要的参数，重新设计，考虑滑动的复杂情况 （Done）
		拆分，实现模块化 改写HiC图像的生成函数，重写下面两个字典
		IncrementSets
		ColorRangeSets
			默认 + 根据实际数据改写，不然造成KeyError，不存在错误


<<<<<<< HEAD
	调整可视化图片的细节
		减小高分辨率的可视化步长, 实现指定大小的错误检测
	
	根据错误大小 > 对应分辨率矩阵 > 返回调整位点
	.hic如何构建
=======
# 5.23
	根据位置信息，获取assembly 中包含的contig (Done)
>>>>>>> f1fcbfe84751c0b2b8bce2a9fb549f9402db1cf8

# 5.25 
	Problems:
		ColorRange (Done)
			查看多种尺寸，更新ColorRange
		步长太小，图片数目过多，无用数据集过多（Done ）
			增大步长，根据分辨率改变长宽，高分辨率情况下（步长直接指定为最大的增量）
			无法确定染色体长度的情况下，手动设置参数（预定义染色体的长度）


# 5.27  
	测试不同分辨率下的，最大长宽 （Done）
		最大长宽 = 分辨率 × 1444


# 5.28 - 31
	项目总结 + 计划 (Done)


# 6.7
	GenHiCPngV3
		PNG > JPG 减少通道操作 (Done )

	Hv.0 生成训练数据	(Done)


# 6.9 
	3 个GSM 的HiCPng 数据生成	Done
		脚本错误，导致无效数据生成  > 已修改完毕，数据正常生成

# 6.13 - 6.14
	* 改写 GenHiCPng
		实现TODO 
		分二种情况：
			1. all2all （Done）
			2. one2one （Done）
		GSM  or  3D-DNA	（Done）

	3个GS 重新生成文件 + 推断 （Done）

	优化bulk_inference	（Done）
	

# 6.16
	修改文件名（加文件前缀） （Done）

	3D-DNA one2one 	（Done）
		让用户提供染色体位置信息


# 6.23
	确定比例是否精确 （Done）
		高分辨率情况下 精确

	调整 目标检测返回结果代码 （Done）



# 6.28
	提示产生图片速度 （Done）
		解决多进程实现图片生成
		留出 进程设置大小


# 7.13
	整理Dell-HiC环境，用于后续测试 （Done）


# 7.14
	更新切割ctg 和 获取ctg起始位点的代码 (Done)


# 7.15
	跑一个Juicer (Doing)

	手动调一个hic ，跑最后一步
		查看需要使用的时间

# 7.16 - 7.20
	根据 目标检测结果（异位） + 插入位置信息， 写处理`assembly`文件的代码 (Done)
		主要是确定异位插入的准确位置


# 7.21 - 7.22
	search_right_site_V2(Done)
		精确易位插入的位置
	
# 7.22 - 7.24
	设计多个易位错误的assembly更新  （Done）
		整合错误插入位置的查找，剪切，插入，修改assembly
		成后后续3d-dna直接使用的`assembly`文件

	整理项目  （Done）

# 7.25
	移动ctgs功能的实现 (Done)

	整合异位全部流程 (Done)

# 8.16  
	查看分辨率，是否会将序列文件减少长度	（Done）
		在不同分辨率下，切一个ctg，查看是否会减少基因组长度

	反转对于`assembly`文件的改变 (Done)

# 8.17
	利用自己生成的assembly文件，跑3D-DNA最后一步 （Done）
		出现问题，与目标文件不符合，主要在方向反向的ctg上出文献，需要调整

# 8.18
	1.debris对于易位调整的影响 (Done)
		确实会造成少一部分序列，长度取决于在什么分辨率下切割

	2.查看自己修改的assembly 文件运行结果是否与程序一致 (Done)
		一致，能够解决问题，并且无debris

# 8.19
	3.将assembly文件的操作，改写为类 (Done)

		新的assembly文件获取信息程序 (Done)

		修改cut_ctg + move_ctg (Done)
			主要是*反向*时的切割和移动

# 8.22 
	move_ctg (Done)

	TODO (Done)

# 8.23
	易位 流程修改 + search_right_site DEBUG (Done)

	易位插入时，是插入在前，还是在后 （Done）
		看占比，具体就是查找区域 靠近在 ctg的右边还是左边

# 8.24
	根据新的类，整合流程 （Done）
		
	将一个ctg切割为3个 （Done）

# 8.25
	*测试两个 易位错误的 调整  (Done)
		主要是切割设计到的文件重复问题

# 8.26
	对比多个错误调整 与 软件 的区别	（Done ）
		无明显区别，易位错误之间存在交叉，可能出现BUG

	调整项目结构 （Done）

	添加时间 time (Done)
		加入了Logger，可以时时查看时间

	格式化项目 （Done）
		已经按照规范，修改

# 8.29
	*正负*ctg反转对于asy的改变 （Done）
		已经跑上，与预想一致

# 8.31
	扩展易位测试数据集，测试
		暂时没有好的测试数据集

	反转数据集生成 （Done）
		已完成hic文件生成，晚上跑图片生成

	图片生成多线程 （Done）

# 9.1
	项目依赖导出，用poetry构建 (Done)

# 9.2 - 9.5
	检查mul_process的BUG，为什么造成了不一样的图片数目（Done）
		根据 1250000中图片信息和info.txt 结合
		> 多线程的切割 与 位点移动产生了冲突，需要重新规划（Done）

	考虑修改图片生成的长宽 / 像素（Done）
		统计juicebox中， 指定分辨率下的合适长宽比例，并记录文件：color_range_sets， len_width_sets， increment_sets
		> juicebox中的长宽，可以通过缩放软件窗口来变化，无参考意义

	反转数据集生成（Done）
		> Np_2: 全部ctg 都反转

	Hv + Ls 反转数据集生成（Done）
		Ls：/home/zgq/work/01.assemble/02.Ls/04.hic_ass/02.3D/04.4th_jzj_inv 
		Hv：/home/zgq/work/01.assemble/01.Hv/02.Hic/05.3D/06.jzj_inv
			9.13 Hv运行仍有问题，已抛弃

# 9.6
	Hv + Ls 互作图像生成（Done）
		> Hv 存在问题：需要等待3d-dna 运行结果

# 9.7
	已有数据进行挑选，全部为反转数据 （Done）

	下载两只鹦鹉的数据集 （Done）


# 9.8
	两只鹦鹉数据集 HiC挂载 （Doing）
		> 正在 130 服务区运行
		9.13 仍在运行
		9.19 仍在运行

# 9.13
	Ls + Hv 随机反转数据生成 
		> 9.13 Doing
		> 9.19 Hv 已运行完毕

# 9.16
	typer （Done）


# 9.19 - 9.21
	inv_ctg 反转代码 （Done）
		一切三 需要判断 （Doing）
		Debug 

# 9.22
	



#  		


	Pre_Config 调整

	斜对角移动fix
		需要提前知道每条染色体的大概长度，才能进行有效的移动


	设计 Debirs 识别与剪切
		尝试解决500 分辨率下，实现冗余片段删除

	染色体边界识别算法
		将ctgs分配到对应的染色体上
		考虑ctg最短长度，用于确定分辨率

	随机ColorRange 生成图片

	染色体长度检测（可能不需要）
		Genome size / chromosome number
		Max chr 



	

	