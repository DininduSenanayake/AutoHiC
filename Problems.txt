2022.4.20-


# 存在的问题
	*动态更新HiC热图
		Method:
			1. 根据`.assembly` 重新生成`.hic`

	.hic 文件中的序列长度和 .assembly文件中的序列长度不一致，
	当Juicer中导入`.assembly`文件后，显示的序列长度和组装基因组的长度一致，猜测其中可能存在缩放映射
	

	滑动可视化 + 图片位点(对应序列信息) + 如果获取调整后的hic热图 + Matrix > PNG

	如何确定每次遍历上错误的位置与contig的对应关系

	错误的大小不确定

	Contact Matrix 的数值规律
		loop 区域周围值的大小问题
		能否直接修改矩阵 + 矩阵太大的操作问题
		直接操作矩阵 + 不能确定规律是否通用（loop区域等）



# 已解决问题
	依旧走Juicer流程，暂时不考虑HiC-Pro等

	`inter.hic` 不能直接可视化，导入Juicer中会出现错误

	`.hic`文件可以根据hicConvertFormat转换至各种格式

	Juicebox 中原始图像序列（draft genome）与 .assembly 的位置关系
		juice热图上方序列位置与 .assembly中 contig的关系
		上方仅是序列长度的叠加，.assenmly中的序列，目前顺序关系还没有确定
		，基本上与genome.fasta中序列暂无顺序关系，图像中的Contig有顺序。
		详见图片


	染色体边界的添加
		只要确定染色体边界的序号，可以修改染色体边界，染色体内是由Contig
		组成的,只要确定染色体内所包含的Contig序号和方向，即可手动添加


	测试手动操作.assembly 并导入juicebox中可视化查看
		可以手动操作，.assembly文件需要和.hic文件一致，不然后出现边界框不匹配的情况，
		主要规律看MarkDown文件中的内容



# 参数设计
	指定滑动窗口的大小（既分辨率）
		参数可以单独 | 范围


	精确错误边界位置，采用2分快速迭代，并设置边界阈值（根据）




# 初步方案
	基于Juicer
		根据.hic文件生成热图
		
		高分辨率下
			错误类型
				MISJOINS
					深度学习识别错误区域，切割contig
				易位
					深度学习识别发生易位区域并定位，根据大致定位，在互作矩阵中寻找需要调整的位置
				翻转（蝴蝶）
					深度学习识别蝴蝶区域并定位，根据大致定位，在互作矩阵中寻找需要调整的位置
						利用寻找loop的思想，找到蝴蝶的翅膀边缘即可确定调整的位置

				冗余位置
					默认调整到调整到最后

			滑动窗口 > 遍历整个热图，实时更新热图，一轮遍历完后，检查一遍

		低分辨率下
			确定染色体边界
				深度学习识别染色体边界并定位，根据大致定位，在互作矩阵中寻找准确的染色体边界

		根据以上内容，修改.assembly文件 

		run-asm-pipeline-post-review.sh -r genome.review.assembly genome.fa aligned/merged_nodups.txt > 最终文件






